<!DOCTYPE HTML>
<html>
	<head>
		<title>QuickySale</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<link rel="stylesheet" href="./jquery-ui.min.css">
		<link rel="stylesheet" href="./lib/bootstrap-3.3.5-dist/css/bootstrap.min.css">
		<link rel="stylesheet" href="./css/style.css">
	</head>
	<body ng-app="QuickySale" ng-controller="QuickySaleCtrl">
		<div class="container-fluid">
			<div class="row">
				<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">

					<h1 class="center">QuickySale</h1>

					<div class="input-group">
						<div class="input-group-addon">
							<span class="glyphicon glyphicon-search"></span>
						</div>
						<input id="search" type="text" class="form-control" placeholder="Rechercher" ng-model="search" />
						<div class="input-group-btn">
							<button class="btn btn-default" ng-click="clearSearchField()"><span class="glyphicon glyphicon-remove"></span></button>
						</div>
					</div>

					<div class="row spacer">
						<div class="col-xs-12 col-sm-12 col-md-3 col-lg-3">
							<button class="btn btn-default" ng-click="toPage('post')" ng-show="currentPage != 'post'">Poster une annonce !</button>
							<button class="btn btn-default" ng-click="toPage('home')" ng-show="currentPage == 'post'"><span class="glyphicon glyphicon-arrow-left" aria-hidden="true"></span> Retour aux annonces</button>
						</div>
						<div class="col-xs-12 col-sm-12 col-md-9 col-lg-9">
							<select class="form-control" ng-model="sortField" ng-show="currentPage == 'home'">
								<option value="default">Trie des annonces</option>
								<option value="dateReverse">Trier par date (du plus récent au plus ancien)</option>
								<option value="date">Trier par date (du plus ancien au plus récent)</option>
								<option value="price">Trier par prix (du moins cher au plus cher)</option>
								<option value="priceReverse">Trier par prix (du plus cher au moins cher)</option>
							</select>
						</div>
					</div>


					<div class="alert alert-info spacer" ng-show="currentPage == 'home'"	>{{filtredAds.length}} résultat<span ng-show="filtredAds.length > 1">s</span></div>

					<table class="table table-striped table-hover spacer" ng-show="currentPage == 'home'">
						<tbody>
							<tr ng-class="{'selected-ad': ad == currentAd, 'clickable': true}" ng-click="toAd(ad)" ng-repeat="ad in filtredAds = (ads | filter:search) | orderBy:sortType:reverse">
								<td>
									<div class="row">
										<div class="col-xs-12 col-sm-6 col-md-4 col-lg-4"><span class="largeText"><div class="label label-default">{{ad.date | date:'dd/MM/yyyy à hh:mm'}}</div></span></div>
										<div class="col-xs-12 col-sm-6 col-md-4 col-lg-4"><span class="largeText" ng-bind-html="ad.title | hightlightSearch:search"></span></div>
										<div class="col-xs-12 col-sm-6 col-md-4 col-lg-4"><span class="largeText">{{ad.price | currency}}</span></div>
									</div>
								</td>
							</tr>
						</tbody>
					</table>

					<button class="btn btn-default spacer" ng-click="toAd()" ng-show="currentAd != null"><span class="glyphicon glyphicon-arrow-left" aria-hidden="true"></span> Retour</button>

					<div class="center spacer well" ng-show="currentPage == 'ad' && currentAd != null">
						<div class="row">
							<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
								<h3 ng-bind-html="currentAd.title | hightlightSearch:search"></h3>
								<div class="largeText spacer">Posté le : <div class="label label-default">{{currentAd.date | date:'dd/MM/yyyy à hh:mm'}}</div></div>
								<p class="spacer largeText" ng-bind-html="currentAd.description | hightlightSearch:search"></p>
								<div class="spacer largeText">Dernière enchère : {{currentAd.price | currency}}</div>
								<div class="input-group spacer">
									<input id="bid-input" class="form-control" placeholder="Encherissez !">
									<span class="input-group-btn"><button class="btn btn-default">Allez-y !</button></span>
								</div>
							</div>
							<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
								<div class="spacer">
									<img class="preview spacer-left" src="{{picture.url}}" ng-repeat="picture in currentAd.pictures" ng-click="enlargePicture(picture)" ng-class="{'enlargedPicture': picture == enlargedPicture}"/>
								</div>
								<div class="spacer"><img src="{{enlargedPicture.url}}" ng-show="enlargedPicture != null"></div>
							</div>
						</div>
					</div>

					<div ng-show="currentPage == 'post'">
						<form name="formNewAd">
							<div class="input-group spacer">
								<span class="input-group-addon">Titre</span>
								<input type="text" class="form-control" ng-model="newAd.title">
							</div>
							<div class="spacer">
							<textarea rows="5" ui-tinymce ng-model="newAd.description"></textarea>
							</div>
							<div class="input-group spacer">
								<span class="input-group-addon">Prix de départ</span>
								<input type="text" class="form-control inputPrice" ng-model="newAd.startingPrice">
							</div>
							<div class="spacer text-center">
								<button class="btn btn-default" ng-click="postAd()">Poster l'annonce</button>
							</div>

							<div class="spacer">
								<pre>{{newAd | json}}</pre>
							</div>
						</form>
					</div>

				</div>
			</div>
		</div>

		<script src="./lib/jquery/jquery-1.11.3.min.js"></script>
		<script src="./lib/jquery/jquery-ui.min.js"></script>
		<script src="./lib/angular/angular.min.js"></script>
		<script src="./lib/angular/angular-sanitize.min.js"></script>
		<script src="./lib/tinymce/js/tinymce/tinymce.min.js"></script>
		<script src="./lib/angular/ui-tinymce.js"></script>
		<script src="./lib/angular/angular-locale_fr-fr.js"></script>
		<script src="./js/app.js"></script>
		<script src="./js/functions.js"></script>
		<script type="text/javascript" src="js/controllers/mainController.js"></script>
		<script type="text/javascript" src="js/controllers/homeController.js"></script>
		<script type="text/javascript" src="js/controllers/inscriptionController.js"></script>
	</body>
</html>